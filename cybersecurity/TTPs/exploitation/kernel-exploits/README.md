---
aliases:
  - kernel exploits
  - kernel exploit
---
# Kernel Exploits
The [kernel](../../../../computers/concepts/kernel.md) of a computer is the *core of the [operating-system](../../../../computers/concepts/operating-system.md)*. It is the layer between the hardware of the computer and the application/user levels of the computer. The kernel has *complete control* over the operating system and exploiting it can result in gaining *SYSTEM level user permissions* (when referring to [Windows](../../../../computers/windows/README.md) systems).
## Finding Kernel Exploits (Windows)
### Finding Windows Version & Patch Level
To find kernel exploits, you first should know the Windows *version and patch level*.
#### `systeminfo`
You can find the Windows version using a command line tool like `systeminfo`:
```cmd
C:\Users\user>systeminfo

Host Name:                 WINDOWS-10-OSCP
OS Name:                   Microsoft Windows 10 Home
OS Version:                10.0.19045 N/A Build 19045
OS Manufacturer:           Microsoft Corporation
OS Configuration:          Standalone Workstation
OS Build Type:             Multiprocessor Free
Registered Owner:          Windows User
Registered Organization:
Product ID:                00326-10000-00000-AA871
Original Install Date:     7/24/2025, 10:14:43 AM
...
```
In this output, the Windows version is `10.0.19045 N/A Build 19045`. 
#### `Get-HotFix`
To determine the patch level, you can run `Get-HotFix` (in [PowerShell](../../../../coding/languages/powershell.md)):
```ps
PS C:\Users\user> Get-Hotfix

Source        Description      HotFixID      InstalledBy          InstalledOn
------        -----------      --------      -----------          -----------
WINDOWS-10... Update           KB5031988                          12/4/2023 12:00:00 AM
WINDOWS-10... Update           KB5011048
WINDOWS-10... Update           KB5015684                          12/4/2023 12:00:00 AM
WINDOWS-10... Security Update  KB5033372                          12/4/2023 12:00:00 AM
WINDOWS-10... Security Update  KB5014032                          12/4/2023 12:00:00 AM
WINDOWS-10... Update           KB5032907                          12/4/2023 12:00:00 AM

PS C:\Users\user>
```
### Find Matching Exploits
Once you have those details, you can find matching exploits by searching online or using tools like [searchsploit](../tools/searchsploit.md), [metasploit](../tools/metasploit.md), or [ExploitDB](../tools/ExploitDB.md).
### Compile and Run
For most kernel exploits, you'll need to [compile](../../../../coding/compilation/compilation.md) them for the correct architecture before running them. **NOTE**: most kernel exploits are unstable and may cause the target machine to crash.
## Tools (Windows target)
There are a few tools you can use to help you find kernel exploits on a target Windows machine.
### Windows Exploit Suggester
[Windows Exploit Suggester](https://github.com/bitsadmin/wesng) (wesng) is a python-based tool which uses the `systeminfo` output on a Windows machine to provide you a list of vulnerabilities for the OS. The output also *includes exploits* for each vulnerability.
#### Use:
The easiest way to use this is to copy the output of `systeminfo` into a text file, and then run `wes.py` (in the cloned wesng directory) giving it the file at runtime. For example:
```cmd
C:\Users\admin>systeminfo  > sysinfo.txt

C:\Users\admin>copy sysinfo.txt \\10.0.69.4\tools\sysinfo.txt
Overwrite \\10.0.69.4\tools\sysinfo.txt? (Yes/No/All): yes
        1 file(s) copied.
```
Once you have the `sysinfo.txt` file on your kali/ linux host (or whatever attacking machine), you can run wesng like this:
```bash
┌─[25-07-24 17:05:50]:(root@10.0.2.15)-[~/tibs/tools/wesng]
└─# python3 wes.py ../sysinfo.txt
Windows Exploit Suggester 1.05 ( https://github.com/bitsadmin/wesng/ )
[+] Parsing systeminfo output
[+] Operating System
    - Name: Windows 10 Version 22H2 for x64-based Systems
    - Generation: 10
    - Build: 19045
    - Version: 22H2
    - Architecture: x64-based
    - Installed hotfixes (6): KB5031988, KB5011048, KB5015684, KB5033372, KB5014032, KB5032907
[+] Loading definitions
    - Creation date of definitions: 20250719
[+] Determining missing patches
[!] Found vulnerabilities!

Date: 20230314
CVE: CVE-2022-29900
KB: KB
Title: AMD: CVE-2022-29900 AMD CPU Branch Type Confusion
Affected product: Windows 10 Version 22H2 for x64-based Systems
Affected component: AMD CPU Branch
Severity: Important
Impact: Information Disclosure
Exploit: n/a

Date: 20230509
CVE: CVE-2022-26928
KB: KB
Title: Windows Photo Import API Elevation of Privilege Vulnerability
Affected product: Windows 10 Version 22H2 for x64-based Systems
Affected component: Windows Photo Import API
Severity: Important
Impact: Elevation of Privilege
Exploit: n/a

Date: 20230201
CVE: CVE-2022-41064
KB: KB5020694
Title: .NET Framework Information Disclosure Vulnerability
Affected product: Microsoft .NET Framework 4.8 on Windows 10 Version 22H2 for x64-based Systems
Affected component: .NET Framework
Severity: Important
Impact: Information Disclosure
Exploit: n/a

...

[-] Missing patches: 13
    - KB: patches 1068 vulnerabilities
    - KB5062554: patches 148 vulnerabilities
    - KB5027538: patches 12 vulnerabilities
    - KB5030180: patches 10 vulnerabilities
    - KB5034275: patches 9 vulnerabilities
    - KB5032339: patches 4 vulnerabilities
    - KB5044091: patches 4 vulnerabilities
    - KB5020694: patches 2 vulnerabilities
    - KB5037036: patches 2 vulnerabilities
    - KB5041019: patches 2 vulnerabilities
    - KB5050188: patches 2 vulnerabilities
    - KBUpdate Information: patches 1 vulnerability
    - KB5046400: patches 1 vulnerability
[I] KB with the most recent release date
    - ID: KB5062554
    - Release date: 20250716
[+] Done. Displaying 1265 of the 1265 vulnerabilities found.
```
### Watson
[Watson](https://github.com/rasta-mouse/Watson) is a "[.NET](../../../../coding/dotNET.md) tool designed to enumerate missing KBs and suggest exploits" for [privesc](../../actions-on-objective/privesc/README.md). Unfortunately, it can only be used on: 
- Windows 10 (1507, 1511, 1607, 1703, 1709, 1803, 1809, 1903, 1909, 2004)
- Server 2016 & 2019
### Pre-compiled Kernel Exploits
[Pre-compiled Windows Kernel Exploits](https://github.com/SecWiki/windows-kernel-exploits) is a GitHub of kernel exploits, however it *hasn't been updated since 2017*.

> [!Resources]
> - [Windows Exploit Suggester](https://github.com/bitsadmin/wesng) 
> - [Watson](https://github.com/rasta-mouse/Watson) 
> - [Pre-compiled Windows Kernel Exploits](https://github.com/SecWiki/windows-kernel-exploits)